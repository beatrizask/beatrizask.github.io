<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Q-</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="page">
    <h1>Quer namorar comigo?</h1>
    <div class="botoes">
      <a id="sim" class="btn" href="sim.html">Sim</a>
      <span class="ghost-nao btn">Não</span>
    </div>
  </div>

  <button id="nao" class="btn" type="button">Não</button>
  <audio id="errou" preload="auto" src="errou.mp3"></audio>

  <script>
  (function () {
    const nao = document.getElementById('nao');
    const ghost = document.querySelector('.ghost-nao');
    const errou = document.getElementById('errou');
    const PAD = 8;
    const TRIGGER_DISTANCE = 70;
    let lastMoveAt = 0;

    function placeNaoOverGhost() {
      const r = ghost.getBoundingClientRect();
      nao.style.left = r.left + 'px';
      nao.style.top = r.top + 'px';
    }

    function playErrou() {
      try { errou.currentTime = 0; errou.play(); } catch (_) {}
    }

    function moveNaoRandom(avoidPoint) {
      const nr = nao.getBoundingClientRect();
      for (let i = 0; i < 30; i++) {
        const left = Math.random() * (window.innerWidth  - nr.width  - PAD*2) + PAD;
        const top  = Math.random() * (window.innerHeight - nr.height - PAD*2) + PAD;
        if (avoidPoint) {
          const cx = left + nr.width / 2;
          const cy = top  + nr.height / 2;
          if (Math.hypot(cx - avoidPoint.x, cy - avoidPoint.y) < TRIGGER_DISTANCE * 1.25) continue;
        }
        nao.style.left = left + 'px';
        nao.style.top  = top  + 'px';
        return;
      }
      nao.style.left = Math.max(PAD, Math.min(window.innerWidth  - nr.width  - PAD, (nao.offsetLeft||0) + 50)) + 'px';
      nao.style.top  = Math.max(PAD, Math.min(window.innerHeight - nr.height - PAD, (nao.offsetTop ||0) + 30)) + 'px';
    }

    function maybeEvade(x, y) {
      const now = performance.now();
      if (now - lastMoveAt < 70) return;
      const r = nao.getBoundingClientRect();
      const cx = r.left + r.width / 2;
      const cy = r.top  + r.height / 2;
      if (Math.hypot(x - cx, y - cy) < TRIGGER_DISTANCE) {
        lastMoveAt = now;
        playErrou();
        moveNaoRandom({ x, y });
      }
    }

    window.addEventListener('load', placeNaoOverGhost);
    window.addEventListener('resize', placeNaoOverGhost);
    window.addEventListener('orientationchange', placeNaoOverGhost);

    window.addEventListener('pointermove', (e) => maybeEvade(e.clientX, e.clientY));
    nao.addEventListener('pointerenter', (e) => { playErrou(); moveNaoRandom({ x: e.clientX, y: e.clientY }); });
    nao.addEventListener('click', (e) => { e.preventDefault(); playErrou(); moveNaoRandom({ x: e.clientX, y: e.clientY }); });
    nao.addEventListener('pointerdown', (e) => { playErrou(); moveNaoRandom({ x: e.clientX, y: e.clientY }); });
  })();
  </script>
</body>
</html>
